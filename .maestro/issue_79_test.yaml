appId: co.solidi.mobile.test
---
# Issue 79: Address Book Ticker API Integration & Search Functionality
# Tests: (1) Asset list loads from /v1/ticker, (2) Search functionality, (3) Destination validation

# Wait for app to be ready
- assertVisible: ".*"
- takeScreenshot: 01_app_ready

# Handle login if needed
- runFlow:
    when:
      visible: "Secure Login|Sign In"
    commands:
      - tapOn: "Secure Login|Sign In"
      - extendedWaitUntil:
          notVisible: "Secure Login|Sign In"
          timeout: 10000

# Navigate to Settings
- tapOn:
    id: "header-settings-button"
- extendedWaitUntil:
    visible: "Wallet & Finance|Account Settings|Personal Details"
    timeout: 10000
- takeScreenshot: 02_settings_page

# Scroll to Address Book
- scroll
- scroll
- extendedWaitUntil:
    visible:
      id: "settings-address-book-item"
    timeout: 5000
- takeScreenshot: 03_address_book_visible

# Tap Address Book
- tapOn:
    id: "settings-address-book-item"
- extendedWaitUntil:
    visible:
      id: "address-book-root"
    timeout: 10000
- takeScreenshot: 04_address_book_page

# Tap Add Address tab
- tapOn:
    id: "address-book-add-tab"
- extendedWaitUntil:
    visible:
      id: "address-book-form-step-1"
    timeout: 10000
- takeScreenshot: 05_step1_recipient_selection

# Select Myself
- tapOn:
    id: "recipient-option-myself"
- takeScreenshot: 06_myself_selected
- scroll
- tapOn:
    id: "button-next"

# Step 2: Auto-filled details
- extendedWaitUntil:
    visible:
      id: "address-book-form-step-2"
    timeout: 10000
- takeScreenshot: 07_step2_autofilled_details
- scroll
- tapOn:
    id: "button-next"

# Step 3: Asset selection - VERIFY TICKER API
- extendedWaitUntil:
    visible:
      id: "address-book-form-step-3"
    timeout: 10000
- takeScreenshot: 08_step3_asset_list_from_ticker

# Test search if visible (> 3 assets)
- runFlow:
    when:
      visible:
        id: "asset-search-input"
    commands:
      - takeScreenshot: 09_search_input_visible
      - tapOn:
          id: "asset-search-input"
      - inputText: "BTC"
      - takeScreenshot: 10_search_filtered_btc
      - assertVisible:
          id: "asset-option-btc"
      - tapOn:
          id: "asset-search-input"
      - eraseText
      - takeScreenshot: 11_search_cleared

# Select BTC
- tapOn:
    id: "asset-option-btc"
- takeScreenshot: 12_btc_selected
- scroll
- tapOn:
    id: "button-next"

# Step 4: Destination - VERIFY VALIDATION FIX
- extendedWaitUntil:
    visible:
      id: "address-book-form-step-4-crypto"
    timeout: 10000
- takeScreenshot: 13_step4_destination_input

# Enter valid BTC address
- tapOn:
    id: "input-withdrawal-address"
- inputText: "1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"
- takeScreenshot: 14_valid_address_entered

# Test complete
- takeScreenshot: 15_test_complete_success
